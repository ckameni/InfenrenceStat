---
title: 'Project: Statistical inference'
author: "Kameni"
date: "Tuesday, October 21, 2014"
output: html_document
---


## Processing the data
```{r}
set.seed(124)
lambda=0.2
sampleSize<-40
n <- 1000; 
means <- replicate(n, mean(rexp(sampleSize,lambda)))
```


we take a look of the first 6 rows of the samplig distribution of

```{r}
head(means)

```


## 1)Show where the distribution is centered at and compare it to the theoretical center of the distribution

the following plot shows that the means' sampling distribution is centered around 5.
In the next step,we  will calculate its  exact value.


```{r}

sas<-function(){
      x<-means
      plot(
            x,
            y=NULL,
            type= "l",
            xlab= "Obs",
            ylab= "means",
            xlim=c(0, 1000), 
            ylim=c(-15,15),
            col="cornflowerblue",
            )
}

sas()

abline(h=mean(means),lwd=2, col="orange")

```


the mean of the distribution is:

```{r}
mean_samp <- mean(means)
mean_samp
```

the theoretical mean of an exponential distribution is:

```{r}
mean_theo <- 1/lambda  #lambda=0.2
mean_theo 
```

 we can see that both means have almost the same value.


Now We want to draw both means in the same plot in order to show that they are almost the same.
 
```{r}
histogram <-function(){
      
xlimits= range(means)
x<-means
hist(x, breaks=20,
     col="cornflowerblue", 
     border="white",
     xlim=xlimits, 
     main="", 
     xlab="means", 
     ylab="Frequeny"
     )
}

histogram()
abline(v=mean(means),col="yellow",lwd=3) 
abline(v=1/.2,col="brown",lwd=3) 
 

```





##2)Show how variable it is and compare it to the theoretical variance of the distribution.


 variation of the sample distribution
```{r}
#the standard deviation of the sample distribution is:
sd_samp <- sd(means)

# therefore the sampling variance is:
var_samp <- var(means)
var_samp

```



the theoretical  variation 
```{r}

#the theoretical standard deviation is:
sd_theo <- (1/lambda)/sqrt(sampleSize)

# and the theoretical variance is:
var_theo <- sd_theo^2
            
var_theo
```


As we can see ,the sampling variance and the theoretical variance are almost the same.

we take a look at the following comparison table to confirm that the differences  between both distributions are very insignificant.

```{r}
comparisonTable<-data.frame(Sampling=numeric(3),theoretical=numeric(3), difference=numeric(3))
rownames(comparisonTable)<-c("mean","sd","var")
comparisonTable[1,]<- c(mean_samp,mean_theo,mean_samp-mean_theo)
comparisonTable[2,]<- c(sd_samp,sd_theo,sd_samp-sd_theo)
comparisonTable[3,]<- c(var_samp,var_theo,var_samp-var_theo) 
comparisonTable
```



##3) Show that the distribution is approximately normal
```{r}
histogram2 <-function(){
      
xlimits= range(means)
x<-means
hist(x, breaks=20,
     prob=TRUE, 
     col="cornflowerblue", 
     border="white",
     xlim=xlimits, 
     main="", 
     xlab="means", 
     ylab="Frequeny"
     )
      lines(density(means), col="orange",lwd=3)
      text(65, 0.025, paste("N =", sum(means)), cex=1.2)     
}

histogram2()

curve(dnorm(x,mean_theo,sd_theo), 0, 8, col="green", add=T,lwd=3)


```


 as we can see from the plots the distribution is aproximately normal.



##4) Evaluate the coverage of the confidence interval 


```{r}

mean_samp + c(-1,1)*1.96*sd_samp/sqrt(40)
```

